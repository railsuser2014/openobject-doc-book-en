


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenOffice.org reports &mdash; Documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="Documentation" href="../../index.html" />
    <link rel="up" title="Reports" href="index.html" />
    <link rel="next" title="XSL:RML reports" href="11_2_XSL-RML_reports.html" />
    <link rel="prev" title="Reports" href="index.html" />
<script src="../../_static/tiny_js_kit_comment_control.js" type="text/javascript"></script>



 

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="11_2_XSL-RML_reports.html" title="XSL:RML reports"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Reports"
             accesskey="P">previous</a> |</li>

          <li><a href="../index.html" >Developer Book</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Reports</a> &raquo;</li> 
      </ul>
    </div>
  <div class="openobject-header">
    <table cellspacing="0" cellpadding="0" border="0" width="1004">
      <tbody>
        <tr>
           <td width="202" class="headerpic">
            <a alt="Open Object - Free Management Solution Logo" href="http://openerp.com">
              <img border="0" src="../../_static/openerp.jpg"/>
            </a>
          </td>
         <td width="335" class="headerpic">
            <div align="right"><img src="../../_static/headerpic.jpg" width="242" height="68" /></div>
          </td>
          <td width="440" valign="top" align="right">
            <table id="Table_01" height="37" border="0" cellpadding="0" cellspacing="0">
              <tr>
                <td class="greycurveleft" width="23px" height="37px"></td>
                <td width="107" class="headerlinkgrey">
                  <div class="headerlink" align="center"><a href="http://openerp.com"><strong>OpenERP</strong></a></div>
                </td>
                <td width="22px" height="37px" class="greyredcurve"></td>
                <td width="125" height="37" class="redline">
                  <div class="headerlink" align="center"><a href="http://ondemand.openerp.com"><strong>OnDemand</strong></a></div>
                </td>
                <td width="20" height="37" class="redcurve">&nbsp;</td>
                <td width="139" height="37" class="redline">
                  <div class="headerlink" align="center"><a href="http://openobject.com"><strong>Community</strong></a></div>
                </td>
                <td width="16" height="37"><img src="../../_static/curve.gif"/></td>
              </tr>
            </table>
            <p class="fortune">Best-selling book on enterprise management</p>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="openobject-navbar">
    <table width="1004" border="0" cellspacing="0" cellpadding="0" id="menu-header">
      <tr>
        <td width="230" id="menu-header" nowrap="nowrap">&nbsp;</td>
        <td id="menu-breadcrumb" nowrap="nowrap">
          
    <div class="related-tiny">
      <h3>Navigation</h3>
      <ul>
        <li class="right">
          <select id="comments_control">
            <option value="">comments control</option>
            <option value="HIDE">hide</option>
            <option value="SHOW">show</option>
          </select>
        </li>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="11_2_XSL-RML_reports.html" title="XSL:RML reports"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Reports"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Developer Book</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Reports</a> &raquo;</li> 
      </ul>
    </div>

        </td>
      </tr>
    </table>
  </div>


      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">OpenOffice.org reports</a><ul>
<li><a class="reference external" href="#creating-a-sxw">Creating a SXW</a></li>
<li><a class="reference external" href="#dynamic-content-in-your-report">Dynamic content in your report</a></li>
<li><a class="reference external" href="#sxw2rml">SXW2RML</a><ul>
<li><a class="reference external" href="#open-report-manual">Open Report Manual</a><ul>
<li><a class="reference external" href="#about">About</a></li>
<li><a class="reference external" href="#sxw-to-rml-script-setup-windows-users">SXW to RML script setup - Windows users</a></li>
<li><a class="reference external" href="#sxw-to-rml-script-setup-linux-open-source-users">SXW to RML script setup - Linux (Open source) users</a></li>
<li><a class="reference external" href="#running-tiny-sxw2rml">Running tiny_sxw2rml</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#tiny-erp-server-pdf-output">Tiny ERP Server PDF Output</a><ul>
<li><a class="reference external" href="#server-pdf-output">Server PDF Output</a><ul>
<li><a class="reference external" href="#id1">About</a></li>
<li><a class="reference external" href="#parser">Parser</a></li>
<li><a class="reference external" href="#the-xml-definition">The xml definition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Reports</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="11_2_XSL-RML_reports.html"
                                  title="next chapter">XSL:RML reports</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/developer/3_11_reports/11_1_openoffice_report.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
<div id="searchbox">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<h3>Open ERP Books</h3><br />
<table cellpading="10px" cellspacing="10px" style="border: 1px solid #98DBCC;" align="center" bgcolor="#FFFFFF">
  <tr>
   <td align="center">
   <span style="text-align:center;">
<iframe src="http://rcm-fr.amazon.fr/e/cm?t=fabsblo-21&o=8&p=8&l=as1&asins=2212122616&fc1=000000&IS2=
1&lt1=_blank&lc1=0000FF&bc1=FFFFFF&bg1=FFFFFF&f=ifr&npa=1" style="width:120px;height:240px;text-align:center;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
</span>
   </td>
  </tr>
  <tr> 
  <td align="center">
<a href="http://www.openerp.com/buy.html?page=shop.product_details&amp;flypage=openerp.tpl&amp;product_id=36&amp;category_id=8" title="Open ERP for Retail and Industrial Management" style="border:none;"><img src="http://www.openerp.com/components/com_virtuemart/shop_image/product/Open_ERP_for_Ret_4a1a9e3e3dec5.png" width="100px" height="134px" style="border:none; text-align:center;"></a>
<p style="font-size:10px;">Retail and Industrial Management, steps towards Sales, Logistics and Manufacturing Integration in the Open Source & Management Collection.</p>
</span>
</td>
</tr>
</table>

        </div>
      </div>


    <div class="document">
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="openoffice-org-reports">
<h1>OpenOffice.org reports<a class="headerlink" href="#openoffice-org-reports" title="Permalink to this headline">¶</a></h1>
<p><strong>The document flow</strong></p>
<p>OpenOffice.org reports are the most commonly used report formats. OpenOffice.org Writer is used (in combination with [[1]]) to generate a RML template, which in turn is used to generate a pdf printable report.</p>
<div align="center" class="figure">
<a class="reference external image-reference" href="../../_images/ooo_report_overview.png"><img alt="../../_images/ooo_report_overview.png" src="../../_images/ooo_report_overview.png" style="width: 642.6px; height: 176.8px;" /></a>
</div>
<p><strong>The internal process</strong></p>
<div align="center" class="figure">
<a class="reference external image-reference" href="../../_images/process_ooo.png"><img alt="../../_images/process_ooo.png" src="../../_images/process_ooo.png" style="width: 680.0px; height: 336.6px;" /></a>
</div>
<p><strong>The .SXW template file</strong></p>
<p><strong>The .RML template</strong></p>
<p><strong>The report engine</strong></p>
<p>in the .RML file will be replaced by the name of the country of the partner of the printed invoice. This report engine produce the same .RML file where all expressions have been replaced by real data.</p>
<p><strong>The final document</strong></p>
<div class="section" id="creating-a-sxw">
<h2>Creating a SXW<a class="headerlink" href="#creating-a-sxw" title="Permalink to this headline">¶</a></h2>
<div class="js-kit-comments" path="/creating-a-sxw" ></div><p>You can design reports using <em>OpenOffice</em>. Here&#8217;s, as an example, the file &#64;&#64;server/bin/addons/sale/report/order.sxw&#64;&#64;.</p>
<div align="center" class="figure">
<a class="reference external image-reference" href="../../_images/writer_report.png"><img alt="../../_images/writer_report.png" src="../../_images/writer_report.png" style="width: 870.4px; height: 652.8px;" /></a>
</div>
</div>
<div class="section" id="dynamic-content-in-your-report">
<h2>Dynamic content in your report<a class="headerlink" href="#dynamic-content-in-your-report" title="Permalink to this headline">¶</a></h2>
<div class="js-kit-comments" path="/dynamic-content-in-your-report" ></div><p><strong>Dynamic content</strong></p>
<p>In the .SXW/.RML reports, you can put some Python code that accesses the Open ERP objects in brackets. The context of the code (the variable&#8217;s values you can use) is the following:</p>
<p><strong>Available variables</strong></p>
<p>Here are Python objects/variables available:</p>
<p>Here are Python functions you can use:</p>
<p>Example of useful tags:</p>
</div>
<div class="section" id="sxw2rml">
<h2>SXW2RML<a class="headerlink" href="#sxw2rml" title="Permalink to this headline">¶</a></h2>
<div class="js-kit-comments" path="/sxw2rml" ></div><div class="section" id="open-report-manual">
<h3>Open Report Manual<a class="headerlink" href="#open-report-manual" title="Permalink to this headline">¶</a></h3>
<div class="section" id="about">
<h4>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h4>
<p>The Open ERP&#8217;s report engine.</p>
<p>Open Report is a module that allows you to render high quality PDF document from an OpenOffice template (.sxw) and any relational database. It can be used as a OpenERP module or as a standalone program.</p>
<p>Open Report has been developed by Fabien Pinckaers.</p>
<p><strong>tiny_sxw2rml</strong> can be found at <a class="reference external" href="http://www.tinyreport.org/download.html">http://www.tinyreport.org/download.html</a></p>
</div>
<div class="section" id="sxw-to-rml-script-setup-windows-users">
<h4>SXW to RML script setup - Windows users<a class="headerlink" href="#sxw-to-rml-script-setup-windows-users" title="Permalink to this headline">¶</a></h4>
<p>In order to use the &#8216;tiny_sxw2rml.py&#8217; Python script you need the following packages installed:</p>
</div>
<div class="section" id="sxw-to-rml-script-setup-linux-open-source-users">
<h4>SXW to RML script setup - Linux (Open source) users<a class="headerlink" href="#sxw-to-rml-script-setup-linux-open-source-users" title="Permalink to this headline">¶</a></h4>
<p>Ensure normalized_oo2rml.xsl is available to tiny_sxw2rml otherwise you will get an error like:</p>
</div>
<div class="section" id="running-tiny-sxw2rml">
<h4>Running tiny_sxw2rml<a class="headerlink" href="#running-tiny-sxw2rml" title="Permalink to this headline">¶</a></h4>
<p>When you have all that installed just edit your report template and run the script with the following command:</p>
<div class="highlight-python"><pre>tiny_sxw2rml.py template.sxw &gt; template.rml</pre>
</div>
<p>Note: <strong>tiny_sxw2rml.py</strong> help suggests that you specify the output file with: &#8220;-o OUTPUT&#8221; but this does not seem to work as of V0.9.3</p>
</div>
</div>
</div>
<div class="section" id="tiny-erp-server-pdf-output">
<h2>Tiny ERP Server PDF Output<a class="headerlink" href="#tiny-erp-server-pdf-output" title="Permalink to this headline">¶</a></h2>
<div class="js-kit-comments" path="/tiny-erp-server-pdf-output" ></div><div class="section" id="server-pdf-output">
<h3>Server PDF Output<a class="headerlink" href="#server-pdf-output" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>About<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>To generate the pdf from the rml file, OpenERP needs a rml parser.</p>
</div>
<div class="section" id="parser">
<h4>Parser<a class="headerlink" href="#parser" title="Permalink to this headline">¶</a></h4>
<p>The parsers are generally put into the folder report of the module. Here is the code for the sale order report:</p>
<p>import time
from report import report_sxw</p>
<div class="highlight-python"><pre>class order(report_sxw.rml_parse):
        def __init__(self, cr, uid, name, context):
                super(order, self).__init__(cr, uid, name, context)
                        self.localcontext.update({
                        'time': time,
                })
        report_sxw.report_sxw('report.sale.order', 'sale.order',
                'addons/sale/report/order.rml', parser=order, header=True)</pre>
</div>
<p>The parser inherit from the <strong>report_sxw.rml_parse</strong> object and it add to the localcontext, the function time so it will be possible to call it in the report.</p>
<p>After an instance of <strong>report_sxw.report_sxw</strong> is created with the parameters:</p>
</div>
<div class="section" id="the-xml-definition">
<h4>The xml definition<a class="headerlink" href="#the-xml-definition" title="Permalink to this headline">¶</a></h4>
<p>To be visible from the client, the report must be declared in an xml file (generally: &#8220;module_name&#8221;_report.xml) that must be put in the <strong>__terp__.py</strong> file</p>
<p>Here is an example for the sale order report:</p>
<div class="highlight-python"><pre>&lt;?xml version="1.0"?&gt;
&lt;terp&gt;
        &lt;data&gt;
                &lt;report
                        id="report_sale_order"
                        string="Print Order"
                        model="sale.order"
                        name="sale.order"
                        rml="sale/report/order.rml"
                        auto="False"/&gt;
                        header="False"/&gt;
        &lt;/data&gt;
&lt;/terp&gt;</pre>
</div>
<p>The arguments are:</p>
</div>
</div>
</div>
</div>


            <br />
            <div class="js-kit-comments" permalink=""></div>
            <script src="http://js-kit.com/comments.js"></script>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">OpenOffice.org reports</a><ul>
<li><a class="reference external" href="#creating-a-sxw">Creating a SXW</a></li>
<li><a class="reference external" href="#dynamic-content-in-your-report">Dynamic content in your report</a></li>
<li><a class="reference external" href="#sxw2rml">SXW2RML</a><ul>
<li><a class="reference external" href="#open-report-manual">Open Report Manual</a><ul>
<li><a class="reference external" href="#about">About</a></li>
<li><a class="reference external" href="#sxw-to-rml-script-setup-windows-users">SXW to RML script setup - Windows users</a></li>
<li><a class="reference external" href="#sxw-to-rml-script-setup-linux-open-source-users">SXW to RML script setup - Linux (Open source) users</a></li>
<li><a class="reference external" href="#running-tiny-sxw2rml">Running tiny_sxw2rml</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#tiny-erp-server-pdf-output">Tiny ERP Server PDF Output</a><ul>
<li><a class="reference external" href="#server-pdf-output">Server PDF Output</a><ul>
<li><a class="reference external" href="#id1">About</a></li>
<li><a class="reference external" href="#parser">Parser</a></li>
<li><a class="reference external" href="#the-xml-definition">The xml definition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Reports</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="11_2_XSL-RML_reports.html"
                                  title="next chapter">XSL:RML reports</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/developer/3_11_reports/11_1_openoffice_report.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
<div id="searchbox">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<h3>Open ERP Books</h3><br />
<table cellpading="10px" cellspacing="10px" style="border: 1px solid #98DBCC;" align="center" bgcolor="#FFFFFF">
  <tr>
   <td align="center">
   <span style="text-align:center;">
<iframe src="http://rcm-fr.amazon.fr/e/cm?t=fabsblo-21&o=8&p=8&l=as1&asins=2212122616&fc1=000000&IS2=
1&lt1=_blank&lc1=0000FF&bc1=FFFFFF&bg1=FFFFFF&f=ifr&npa=1" style="width:120px;height:240px;text-align:center;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
</span>
   </td>
  </tr>
  <tr> 
  <td align="center">
<a href="http://www.openerp.com/buy.html?page=shop.product_details&amp;flypage=openerp.tpl&amp;product_id=36&amp;category_id=8" title="Open ERP for Retail and Industrial Management" style="border:none;"><img src="http://www.openerp.com/components/com_virtuemart/shop_image/product/Open_ERP_for_Ret_4a1a9e3e3dec5.png" width="100px" height="134px" style="border:none; text-align:center;"></a>
<p style="font-size:10px;">Retail and Industrial Management, steps towards Sales, Logistics and Manufacturing Integration in the Open Source & Management Collection.</p>
</span>
</td>
</tr>
</table>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="11_2_XSL-RML_reports.html" title="XSL:RML reports"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Reports"
             >previous</a> |</li>

          <li><a href="../index.html" >Developer Book</a> &raquo;</li>
          <li><a href="index.html" >Reports</a> &raquo;</li> 
      </ul>
    </div>


    <div class="related-tiny">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I" class="bottom-nav-links" >index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M" class="bottom-nav-links" >modules</a> |</li>
        <li class="right" >
          <a href="11_2_XSL-RML_reports.html" title="XSL:RML reports"
             accesskey="N" class="bottom-nav-links" >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Reports"
             accesskey="P" class="bottom-nav-links" >previous</a> |</li>
        <li><a href="../../index.html">Documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Developer Book</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Reports</a> &raquo;</li>
        
      </ul>
    </div>

    <div class="footer">
      &copy; <a href="../../copyright.html">Copyright</a> .
      Last updated on 2009-07-16.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
<script type="text/javascript">

var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));

try {
  var pageTracker = _gat._getTracker("UA-7333765-8");
  pageTracker._trackPageview();
} catch(err) {}

</script>

  </body>
</html>